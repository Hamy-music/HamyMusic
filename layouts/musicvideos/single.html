<!DOCTYPE html>
<html lang="{{ .Site.Language.Lang }}">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ .Title }} - {{ .Site.Title }}</title>
    <link rel="stylesheet" href="/css/style.css">
    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="icon" href="/kuvat/favicon.png" type="image/png">
    <link rel="apple-touch-icon" sizes="32x32" href="/kuvat/favicon.png">
</head>

<body>
    <header>
        <div id="nav">
            <ul id="nav-list">
                <li><a href="https://open.spotify.com/artist/2t5pBK7XsEqYnTVHv3kMes?si=wX8svzSeRJmHc0Sd_nVS8A" target="_blank"><span>Spotify</span></a></li>
                <li><a href="http://www.youtube.com/@hamy_music_finland" target="_blank"><span>YouTube</span></a></li>
                <li><a href="https://www.facebook.com/hamymusiikki" target="_blank"><span>Facebook</span></a></li>
                <li><a href="https://www.instagram.com/hamy_music_finland" target="_blank"><span>Instagram</span></a></li>
                <li><a href="https://www.levykauppax.fi/artist/hamy/?srsltid=AfmBOoot1ymV4ld4QBDZ3sKl2RbUl16rIp0n2EuPiJO09G0gM2TEghON" target="_blank"><span>Levykauppa Äx</span></a></li>
            </ul>
        </div>
    </header>

    <main>
        <section>
            <h1>{{ .Title }}</h1>
            <div class="content">
                {{ .Content }}
            </div>
        </section>

        {{ if eq .Site.Language.Lang "fi" }}
        <section>
            <h2>VIDEOT</h2>
            <div class="video-carousel">
                <ul>
                    {{ range sort .Site.Data.fi_musicvideos "upload_date" "desc" }}
                        <li>
                            <a href="https://www.youtube.com/watch?v={{ .video_id }}" target="_blank">
                                <img src="https://img.youtube.com/vi/{{ .video_id }}/0.jpg" alt="YouTube Video Thumbnail for {{ .video_id }}">
                            </a>
                        </li>
                    {{ end }}
                </ul>
                <ol>
                    {{ range $index, $video := .Site.Data.fi_musicvideos }}
                        <li><a href="#slide{{ add $index 1 }}"></a></li>
                    {{ end }}
                </ol>
                <div class="prev">&lsaquo;</div>
                <div class="next">&rsaquo;</div>
            </div>
        </section>
        {{ else if eq .Site.Language.Lang "en" }}
        <section>
            <h2>VIDEOS</h2>
            <div class="video-carousel">
                <ul>
                    {{ range sort .Site.Data.en_musicvideos "upload_date" "desc" }}
                        <li>
                            <a href="https://www.youtube.com/watch?v={{ .video_id }}" target="_blank">
                                <img src="https://img.youtube.com/vi/{{ .video_id }}/0.jpg" alt="YouTube Video Thumbnail for {{ .video_id }}">
                            </a>
                        </li>
                    {{ end }}
                </ul>
                <ol>
                    {{ range $index, $video := .Site.Data.en_musicvideos }}
                        <li><a href="#slide{{ add $index 1 }}"></a></li>
                    {{ end }}
                </ol>
                <div class="prev">&lsaquo;</div>
                <div class="next">&rsaquo;</div>
            </div>
        </section>
        {{ end }}
    </main>

    <footer>
        <p>&copy; {{ now.Format "2006" }} {{ .Site.Title }}</p>
    </footer>

<script>
document.addEventListener('DOMContentLoaded', function () {
    const carousels = document.querySelectorAll('.video-carousel');

    carousels.forEach(function (carousel) {
        const ul = carousel.querySelector('ul');
        const nextBtn = carousel.querySelector('.next');
        const prevBtn = carousel.querySelector('.prev');
        const bullets = carousel.querySelectorAll('ol li');
        const slides = carousel.querySelectorAll('ul li');

        if (slides.length < 2) return;

        let currentIndex = 0;

        const slideWidth =
            slides[1].offsetLeft - slides[0].offsetLeft;

        function updateSelected() {
            bullets.forEach(b => b.classList.remove('selected'));
            slides.forEach(s => s.classList.remove('selected'));

            if (bullets[currentIndex]) bullets[currentIndex].classList.add('selected');
            if (slides[currentIndex]) slides[currentIndex].classList.add('selected');
        }

        function scrollToIndex(index) {
            currentIndex = Math.max(0, Math.min(index, slides.length - 1));
            ul.scrollTo({
                left: slides[currentIndex].offsetLeft,
                behavior: 'smooth'
            });
            updateSelected();
        }

        // NAPIT — yksi klikkaus = yksi video
        nextBtn.addEventListener('click', () => {
            scrollToIndex(currentIndex + 1);
        });

        prevBtn.addEventListener('click', () => {
            scrollToIndex(currentIndex - 1);
        });

        // BULLETIT
        bullets.forEach((bullet, index) => {
            bullet.addEventListener('click', (e) => {
                e.preventDefault();
                scrollToIndex(index);
            });
        });

        // SCROLL / SWIPE
        let scrollTimeout;
        ul.addEventListener('scroll', () => {
            clearTimeout(scrollTimeout);
            scrollTimeout = setTimeout(() => {
                currentIndex = Math.round(ul.scrollLeft / slideWidth);
                updateSelected();
            }, 100);
        });

        // INIT
        updateSelected();
    });
});
</script>

</body>

</html>
